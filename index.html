<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResearchAgent</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app-container">

        <nav class="panel left-panel">
            <div class="panel-header">
                <button id="new-task-button" class="new-task-btn">+ New Task</button>
            </div>
            <ul id="task-list" class="task-list scrollable-content">
                <li class="task-item-placeholder">Loading tasks...</li>
            </ul>
            
            <div id="token-usage-area" class="token-usage-area">
                <p><span class="token-label">Last Call:</span> <span id="last-call-tokens">N/A</span></p>
                <p><span class="token-label">Task Total:</span> <span id="task-total-tokens">N/A</span></p>
            </div>
            <div class="upload-area">
                <input type="file" id="file-upload-input" multiple style="display: none;">
                <button id="upload-file-button" class="upload-button" title="Upload files to current task workspace" disabled>Upload File(s)</button>
            </div>
            <div class="panel-footer">
                <div class="app-credits">
                    ResearchAgent<br>
                    <span style="font-size: 0.9em;">Developed by Valerio Bianchi &amp; Gemini</span>
                    </div>
            </div>
        </nav>

        <main class="panel center-panel">
            <div class="panel-header chat-header">
                <h3 id="current-task-title">No Task Selected</h3>
                <div class="chat-header-llm-controls">
                    <div class="llm-selector-group">
                        <label for="intent-llm-select">Intent Classifier:</label>
                        <select id="intent-llm-select" class="role-llm-select" title="Override LLM for Intent Classification (session)">
                            <option value="">Use System Default</option>
                        </select>
                    </div>
                    <div class="llm-selector-group">
                        <label for="planner-llm-select">Planner:</label>
                        <select id="planner-llm-select" class="role-llm-select" title="Override LLM for Planning (session)">
                            <option value="">Use System Default</option>
                        </select>
                    </div>
                    <div class="llm-selector-group">
                        <label for="controller-llm-select">Controller:</label>
                        <select id="controller-llm-select" class="role-llm-select" title="Override LLM for Controller/Validator (session)">
                            <option value="">Use System Default</option>
                        </select>
                    </div>
                    <div class="llm-selector-group">
                        <label for="llm-select">Executor LLM:</label> <select id="llm-select" class="llm-selector" title="Select LLM for current session execution (Executor)">
                            <option value="">Loading LLMs...</option>
                        </select>
                    </div>
                    <div class="llm-selector-group">
                        <label for="evaluator-llm-select">Evaluator:</label>
                        <select id="evaluator-llm-select" class="role-llm-select" title="Override LLM for Evaluation (session)">
                            <option value="">Use System Default</option>
                        </select>
                    </div>
                </div>
                </div>
            <div id="chat-messages" class="chat-messages scrollable-content">
                <div id="agent-thinking-status" class="message message-status agent-thinking-status" style="display: none;">Thinking...</div>
            </div>
            <div class="chat-input-area">
                <textarea placeholder="Type your message here..."></textarea>
                <button>Send</button>
            </div>
        </main>

        <aside class="panel right-panel">
            <div class="panel-header monitor-header">
                <h3>Agent Workspace</h3>
                <div class="monitor-controls"> <div id="monitor-status-container" class="monitor-status-container">
                    <span id="status-dot" class="status-dot disconnected"></span>
                    <span id="monitor-status-text" class="monitor-status-text">Disconnected</span>
                </div>
                <button id="stop-button" class="stop-button">STOP</button>
                </div>
            </div>

            <div class="monitor-split-content">
                <div id="monitor-log-area" class="monitor-log-area scrollable-content">
                </div>
                <div id="monitor-artifact-area" class="monitor-artifact-area">
                    <div class="artifact-placeholder">No artifacts generated yet.</div>
                    <div class="artifact-nav">
                        <button id="artifact-prev-btn" class="artifact-nav-btn" disabled>&lt; Prev</button>
                        <span id="artifact-counter" class="artifact-counter"></span>
                        <button id="artifact-next-btn" class="artifact-nav-btn" disabled>Next &gt;</button>
                    </div>
                </div>
            </div>
        </aside>
    </div>
    <script src="js/state_manager.js"></script>
    <script src="js/websocket_manager.js"></script>
    <script src="js/ui_modules/task_ui.js"></script>
    <script src="js/ui_modules/chat_ui.js"></script>
    <script src="js/ui_modules/monitor_ui.js"></script>
    <script src="js/ui_modules/artifact_ui.js"></script>
    <script src="js/ui_modules/llm_selector_ui.js"></script>
    <script src="js/ui_modules/token_usage_ui.js"></script>
    <script src="js/ui_modules/file_upload_ui.js"></script>
    <script src="js/script.js"></script>
</body>
</html>
