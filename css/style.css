/* css/style.css - Dark Theme with Structured Logs & Split Monitor */

/* Basic Reset & Root Variables */
:root {
    /* Dark Theme Colors */
    --bg-color: #1a1d21;
    --panel-bg: #202328;
    --panel-bg-lighter: #2c3035;
    --panel-bg-lightest: #383c42;
    --border-color: #3a3f44;
    --text-color: #d1d5db;
    --text-color-muted: #9ca3af;
    --text-color-darker: #6b7280;
    --accent-color: #4a90e2;
    --accent-color-hover: #5aa1f2;
    --error-color: #f36b6b;
    --tool-color: #a5d6ff; /* Light blue for tool logs */
    --system-color: #6b7280; /* Muted grey for system logs */
    --image-color: #84cc16; /* Lime green for image logs */
    --warning-bg: rgba(247, 144, 9, 0.1);
    --warning-border: #f79009;
    --terminal-bg: #111315;
    --terminal-text: #c4c7ca;
    --code-bg: #2c3035;
    --code-text: #e5e7eb;

    --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    --monospace-font: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; font-family: var(--font-family); background-color: var(--bg-color); color: var(--text-color); font-size: 14px; overflow: hidden; }

/* Main App Layout */
.app-container { display: flex; height: 100vh; }
.panel { display: flex; flex-direction: column; background-color: var(--panel-bg); height: 100%; overflow: hidden; }
.panel:not(:last-child) { border-right: 1px solid var(--border-color); }

/* Headers & Footers */
.panel-header, .panel-footer, .monitor-footer, .chat-header, .monitor-header { padding: 10px 15px; background-color: var(--panel-bg); border-bottom: 1px solid var(--border-color); flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; min-height: 45px; }
.panel-footer { border-bottom: none; border-top: 1px solid var(--border-color); margin-top: auto; color: var(--text-color-muted); font-size: 0.85em; }
.monitor-footer { border-bottom: none; border-top: 1px solid var(--border-color); background-color: var(--terminal-bg); display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; font-size: 0.9em; color: var(--text-color-muted); }
.monitor-footer span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding-right: 10px; }
.jump-live-btn { background: var(--panel-bg-lightest); border: 1px solid var(--border-color); color: var(--text-color-muted); padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: all 0.2s ease; flex-shrink: 0; }
.jump-live-btn:hover { background-color: var(--panel-bg-lighter); color: var(--text-color); border-color: var(--text-color-muted); }

/* Scrollable Content */
.scrollable-content { flex-grow: 1; overflow-y: auto; scrollbar-width: thin; scrollbar-color: var(--panel-bg-lightest) var(--panel-bg); }
.scrollable-content::-webkit-scrollbar { width: 8px; }
.scrollable-content::-webkit-scrollbar-track { background: var(--panel-bg); }
.scrollable-content::-webkit-scrollbar-thumb { background-color: var(--panel-bg-lightest); border-radius: 4px; border: 2px solid var(--panel-bg); }

/* Left Panel */
.left-panel { flex: 0 0 280px; }
.new-task-btn { background-color: var(--accent-color); color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-weight: 500; font-size: 0.9em; transition: background-color 0.2s ease; }
.new-task-btn:hover { background-color: var(--accent-color-hover); }
.task-list { list-style: none; padding: 8px 0; }
.task-item { padding: 10px 15px; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 0.9em; border-left: 3px solid transparent; transition: background-color 0.2s ease; display: flex; justify-content: space-between; align-items: center; }
.task-item.active { background-color: var(--panel-bg-lighter); font-weight: 500; color: var(--text-color); border-left-color: var(--accent-color); }
.task-item.active .task-delete-btn { color: var(--text-color-muted); opacity: 0.7; }
.task-item.active .task-delete-btn:hover { opacity: 1.0; color: var(--error-color); }
.task-item:hover { background-color: var(--panel-bg-lightest); }
.task-item-placeholder { color: var(--text-color-muted); padding: 0.75rem; text-align: center; font-style: italic; }
.task-title { flex-grow: 1; margin-right: 0.5rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.task-delete-btn { background: none; border: none; color: var(--text-color-darker); cursor: pointer; font-size: 1rem; padding: 0 0.25rem; line-height: 1; opacity: 0.5; transition: opacity 0.2s ease, color 0.2s ease; }
.task-delete-btn:hover { opacity: 1.0; color: var(--error-color); }

/* Center Panel */
.center-panel { flex: 1; background-color: var(--bg-color); }
.chat-header { background-color: var(--panel-bg); border-bottom: 1px solid var(--border-color); }
.chat-header h3 { margin: 0; font-size: 1em; font-weight: 500; }
.chat-header span { font-size: 0.9em; color: var(--text-color-muted); }
.chat-messages { padding: 20px; display: flex; flex-direction: column; gap: 18px; }
.message { padding: 10px 15px; border-radius: 8px; max-width: 85%; line-height: 1.5; font-size: 0.95em; word-wrap: break-word; overflow-wrap: break-word; white-space: normal; }
.message-agent { background-color: var(--panel-bg); align-self: flex-start; border: 1px solid var(--border-color); }
.message-user { background-color: var(--accent-color); color: white; align-self: flex-end; border: 1px solid var(--accent-color); }
.message-status { background-color: transparent; border: none; color: var(--text-color-muted); font-size: 0.9em; align-self: center; padding: 5px 12px; text-align: center; max-width: 100%; }
.message-status.connection-status { font-weight: 500; }
.message-status.error-message { color: var(--error-color); font-weight: 500; }
.message-suggestion{ background-color: transparent; border: 1px dashed var(--border-color); border-left: 3px solid var(--warning-border); color: var(--text-color-muted); align-self: stretch; padding: 8px 12px; }
.message-warning { background-color: var(--warning-bg); border: 1px solid var(--warning-border); color: var(--text-color); padding: 10px 15px; border-radius: 4px; margin-top: 5px; font-size: 0.9em; align-self: stretch; }
.action-prompt { background-color: var(--panel-bg); border: 1px solid var(--border-color); padding: 15px; border-radius: 5px; margin-top: 10px; align-self: stretch; }
.action-prompt p { margin-bottom: 10px; font-weight: 500; color: var(--text-color); }
.action-btn { background-color: var(--accent-color); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; font-size: 0.9em; font-weight: 500; transition: background-color 0.2s ease; }
.action-btn:hover { background-color: var(--accent-color-hover); }
.chat-input-area { display: flex; padding: 10px 15px; border-top: 1px solid var(--border-color); background-color: var(--panel-bg); flex-shrink: 0; align-items: flex-end; }
.chat-input-area textarea { flex-grow: 1; padding: 8px 12px; border: 1px solid var(--border-color); border-radius: 5px; background-color: var(--panel-bg-lighter); color: var(--text-color); resize: none; min-height: 38px; max-height: 150px; margin-right: 10px; font-family: inherit; font-size: 0.95em; line-height: 1.4; overflow-y: auto; }
.chat-input-area textarea:focus { outline: none; border-color: var(--accent-color); box-shadow: 0 0 0 1px var(--accent-color); }
.chat-input-area button { padding: 8px 15px; background-color: var(--accent-color); color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: 500; height: 38px; transition: background-color 0.2s ease; }
.chat-input-area button:hover { background-color: var(--accent-color-hover); }

/* Right Panel: Monitor */
.right-panel { flex: 0 0 450px; background-color: var(--terminal-bg); }
.monitor-header { background-color: var(--terminal-bg); border-bottom-color: var(--border-color); }
.monitor-header h3 { margin: 0; font-size: 1em; font-weight: 500; }
.monitor-header span { font-size: 0.85em; color: var(--text-color-darker); }

/* *** NEW: Monitor Split Layout *** */
.monitor-split-content {
    flex-grow: 1; /* Takes up space between header and footer */
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevent content overflowing the panel */
}

.monitor-log-area {
    flex: 3 1 0; /* Takes up ~3/4 of the space, can shrink/grow */
    overflow-y: auto; /* Allow scrolling for logs */
    padding: 10px 15px; /* Add padding */
    background-color: var(--terminal-bg);
    font-family: var(--monospace-font);
    font-size: 0.85em;
    line-height: 1.5;
    color: var(--terminal-text);
    border-bottom: 1px solid var(--border-color); /* Separator line */
}

.monitor-artifact-area {
    flex: 1 1 0; /* Takes up ~1/4 of the space, can shrink/grow */
    overflow-y: auto; /* Allow scrolling if artifact is tall */
    padding: 10px 15px;
    background-color: var(--panel-bg); /* Slightly lighter bg */
    display: flex; /* Center placeholder */
    justify-content: center;
    align-items: center;
}

.artifact-placeholder {
    color: var(--text-color-darker);
    font-style: italic;
}
/* *** End Split Layout *** */


/* Individual Log Entry Styling (Applied within monitor-log-area) */
.monitor-log-entry { margin-bottom: 8px; padding: 6px 10px; border-radius: 4px; border: 1px solid var(--border-color); background-color: var(--panel-bg); display: flex; flex-direction: column; }
.log-timestamp { font-size: 0.8em; color: var(--text-color-darker); margin-bottom: 4px; white-space: nowrap; }
.log-content { white-space: pre-wrap; word-wrap: break-word; color: var(--text-color); }

/* Styling for different log types */
.log-type-system { border-left: 3px solid var(--text-color-muted); }
.log-type-tool-start { border-left: 3px solid var(--tool-color); background-color: var(--panel-bg-lighter); }
.log-type-tool-output .log-content pre,
.log-type-tool-error .log-content pre { background-color: var(--terminal-bg); color: var(--terminal-text); padding: 5px 8px; margin-top: 4px; border-radius: 3px; border: 1px solid var(--border-color); overflow-x: auto; white-space: pre; }
.log-type-tool-output { border-left: 3px solid var(--tool-color); }
.log-type-tool-error { border-left: 3px solid var(--error-color); background-color: rgba(243, 107, 107, 0.05); }
.log-type-tool-error .log-content { color: var(--error-color); }
.log-type-agent-finish { border-left: 3px solid var(--accent-color); }
.log-type-error { border-left: 3px solid var(--error-color); background-color: rgba(243, 107, 107, 0.05); }
.log-type-error .log-content { color: var(--error-color); }
.log-type-history { opacity: 0.7; border-left: 3px solid var(--text-color-darker); }
.log-type-unknown { border-left: 3px dashed var(--text-color-darker); }
.log-type-image-generated { border-left: 3px solid var(--image-color); } /* Style for the text log */

/* Styles for Artifact Area Content */
.monitor-artifact-area img {
    display: block;
    max-width: 100%; /* Ensure image fits within the artifact area */
    max-height: 100%; /* Ensure image fits vertically too */
    height: auto; /* Maintain aspect ratio */
    object-fit: contain; /* Scale down large images, preserving aspect ratio */
    border-radius: 4px;
    border: 1px solid var(--border-color);
}
.monitor-artifact-area .artifact-error { /* Style error text within image log */
    font-size: 0.9em;
    font-style: italic;
    color: var(--error-color);
}


/* Styling for Code Blocks within Chat Messages */
.message-agent pre { background-color: var(--code-bg); border: 1px solid var(--border-color); border-radius: 4px; padding: 0.75rem; margin: 0.5rem 0; overflow-x: auto; white-space: pre; }
.message-agent pre code { font-family: var(--monospace-font); font-size: 0.9em; color: var(--code-text); background-color: transparent; padding: 0; border: none; white-space: pre; }


/* Responsive Adjustments */
@media (max-width: 768px) {
    .app-container { flex-direction: column; height: auto; min-height: 100vh; }
    .left-panel, .right-panel, .center-panel { flex: 1 1 auto; height: auto; min-height: 200px; }
    .left-panel { order: 1; } .center-panel { order: 2; } .right-panel { order: 3; }
    .panel:not(:last-child) { border-right: none; border-bottom: 1px solid var(--border-color); }
}
