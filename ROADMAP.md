ResearchAgent: Project Roadmap (v2.5.3 Target Base)
===================================================

This document outlines the planned development path for the ResearchAgent project. It is a living document and will be updated as the project evolves.

Guiding Principles for Development
----------------------------------

-   Accuracy & Reliability Over Speed

-   User-in-the-Loop (UITL/HITL)

-   Modularity & Maintainability

-   Extensibility

Phase 1: Core Stability & Foundational Tools (Largely Complete - Basis of v2.5.2)
---------------------------------------------------------------------------------

-   UI Framework: Three-panel layout.

-   Backend Infrastructure: Python, WebSockets, `aiohttp`.

-   Task Management: Persistent storage, UI updates.

-   Core Agent Flow (P-C-E-E Pipeline): Intent Classification, Planner, Controller, Executor, Step Evaluator, Overall Plan Evaluator.

-   Core Tools Implemented & Refined.

-   LLM Configuration: Google Gemini & Ollama, role-specific selection.

-   Frontend & Backend Refactoring (Modularization).

-   Backend Plan Proposal Mechanism.

Phase 2: Enhanced Agent Capabilities & User Experience (Current & Near-Term Focus - Targeting v2.5.3)
-----------------------------------------------------------------------------------------------------

1.  Core Agent Execution Stability & Feature Verification (COMPLETE)

    -   `deep_research_synthesizer` & `write_file` Flow:

        -   Status: RESOLVED. Controller, Agent, and Evaluator logic refined for robust execution. The actual research report content is now correctly generated by `deep_research_synthesizer` and subsequently saved to a file by `write_file`.

    -   Controller Prompt Formatting `KeyError`:

        -   Status: RESOLVED.

    -   Backend `IndentationError` in `agent_flow_handlers.py`:

        -   Status: RESOLVED.

2.  Refine Chat UI/UX & Message Flow (High Priority - Frontend Implementation Next)

    -   Goal: Implement a cleaner, `manus.ai`-inspired chat interface as detailed in `BRAINSTORM.md` and the conceptual `simulation.html`. This includes:

        -   Sequential major step announcements and significant sub-statuses (each with colored side-lines, no bubbles).

        -   A persistent bottom "thinking" line for low-level LLM activity.

        -   Clear, bubbled final agent messages.

        -   Persistent status messages (reloaded from history).

    -   Backend Support Status: COMPLETE.

        -   `callbacks.py`: Sends structured `agent_thinking_update` with `component_hint`. Refined error reporting.

        -   `agent_flow_handlers.py`: Sends new `agent_major_step_announcement` type; other thinking updates include `component_hint`.

        -   `server.py` & `task_handlers.py`: Implemented persistence for `status_message` types in chat history.

    -   Frontend Implementation Status: PENDING.

        -   Update `script.js` (from user-provided baseline) to dispatch `agent_major_step_announcement`.

        -   Update `chat_ui.js` (from user-provided baseline) to render major steps, sequential sub-statuses, and manage the persistent bottom thinking line.

        -   Update `style.css` (from user-provided baseline) with all necessary styles for the new message appearances and colored side-lines.

3.  BUG FIX (Medium Priority): Chat Input Unresponsive

    -   Issue: Chat input can lock up after a task completes or errors out.

    -   PENDING: Ensure agent status flags (`isAgentRunning` in `StateManager`) are correctly reset and UI re-enables input, potentially tied to the final "Idle" state of the persistent bottom thinking line.

4.  DEBUG (Medium Priority): Monitor Log Color-Coding

    -   Goal: Visually differentiate Monitor Log messages by source.

    -   PENDING/DEBUG: CSS rules in `style.css` need to be created/verified. Ensure `log_source` consistency from all backend logging points.

5.  Fix (Low Priority): `<strong>` Tag Rendering in Chat

    -   Issue: User noted some HTML tags (like `<strong>`) not rendering correctly in specific chat messages.

    -   PENDING: To be addressed during the `chat_ui.js` update by ensuring `innerHTML` is consistently used for formatted content.

Phase 3: Advanced Interactivity & Tooling (Mid-Term)
----------------------------------------------------

(No changes to this section's general goals yet)

-   Advanced User-in-the-Loop (UITL/HITL) Capabilities (Editable plans, step-level intervention).

-   New Tools & Tool Enhancements (Code Interpreter, Data Visualization, DB Querying, Playwright activation).

-   Workspace RAG.

-   Improved Agent Memory & Context Management.

Phase 4: Advanced Agent Autonomy & Specialized Applications (Longer-Term)
-------------------------------------------------------------------------

(No changes to this section's general goals yet)

-   Advanced Re-planning & Self-Correction.

-   User Permissions & Resource Gateway.

-   Streaming Output.

-   Specialized Agent Personas & Workflows.

-   Collaborative Features.

This roadmap will guide our development efforts. Feedback and adjustments are welcome.